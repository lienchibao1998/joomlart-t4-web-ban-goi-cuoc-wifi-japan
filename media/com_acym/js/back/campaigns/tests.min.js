jQuery(function(e){e("#launch_spamtest").off("click").on("click",function(){if(e(this).hasClass("disabled"))return!1;e(this).addClass("disabled"),e(".acym_icon_container").find('i:not(".acymicon-question-circle-o")').removeClass().html("").addClass("acymicon-circle-o-notch acymicon-spin"),e(".acym_check_results").hide().html(""),e("#acym_spam_test_details").addClass("is-hidden"),e("#safe_check_results").removeClass("is-hidden"),c("Content","check_words","checkContent"),c("Links","check_links","checkLinks"),e("#check_spam").find("i").hasClass("acymicon-question-circle-o")?e(".acym__campaigns__test__pro").toggle():c("SPAM","check_spam","checkSPAM")}),e("#acym_spam_test_details button").off("click").on("click",function(){e("#check_spam").trigger("click")}),e("#acym__campaign__send-test").off("click").on("click",function(){e("#acym__campaigns__send-test__spinner").show();let a=e(this);a.attr("disabled","true");let c=ACYM_AJAX_URL+"&page=acymailing_campaigns&ctrl=campaigns&task=test&id="+e('input[name="id"]').val()+"&test_note="+encodeURIComponent(jQuery("#acym__wysid__send__test__note").val())+"&test_emails="+encodeURIComponent(e(".acym__multiselect__email").val().join(","));e.post(c,function(c){a.removeAttr("disabled"),e("#acym__campaigns__send-test__spinner").hide(),c=acym_helper.parseJson(c),acym_helperNotification.addNotification(c.message,c.error?"error":"info")})});let a=0;function c(c,s,t){let i=e('input[name="id"]').val(),l=e("#"+s).removeClass("acym_clickable").off("click"),n=l.find(".acym_icon_container i");acym_helper.get(ACYM_AJAX_URL+"&ctrl=campaigns&task="+t+"&id="+i).then(s=>{if("SPAM"===c)if(s.error)l.next(".acym_check_results").html(s.message),l.addClass("acym_clickable").on("click",function(){e(this).next(".acym_check_results").slideToggle()}),n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red");else{l.next(".acym_check_results").html(ACYM_JS_TXT.ACYM_TESTS_SPAM_SENT).show();let a=0,c=setInterval(function(){a++,acym_helper.get(s.data.url+"&format=json").then(t=>{!1!==t.status?(clearInterval(c),l.next(".acym_check_results").hide(),e("#acym_spam_test_details").removeClass("is-hidden"),t.mark>-2?n.removeClass().addClass("acymicon-check-circle acym_icon_green"):n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),l.attr("data-open")||l.attr("data-open",l.attr("data-iframe")),l.addClass("acym_clickable").attr("data-iframe",s.data.url+"&lang="+s.data.lang),acym_helperModal.initModal()):a>5&&(l.next(".acym_check_results").html(t.title),l.addClass("acym_clickable").on("click",function(){e(this).next(".acym_check_results").slideToggle()}),n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),clearInterval(c))})},1e4)}else s.data.result.length>0?(n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),l.addClass("acym_clickable").on("click",function(){e(this).next(".acym_check_results").slideToggle()}),l.next(".acym_check_results").html(s.data.result)):n.removeClass().addClass("acymicon-check-circle acym_icon_green");3===++a&&(a=0,e("#launch_spamtest").removeClass("disabled"))})}});