/**
 * @copyright  (C) 2018 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */if(!window.Joomla)throw new Error("core.js was not properly initialised");Joomla.submitbutton=(e,m)=>{e==="item.setType"||e==="item.setMenuType"?(e==="item.setType"?([].slice.call(document.querySelectorAll('#item-form input[name="jform[type]"]')).forEach(t=>{t.value=m}),document.getElementById("fieldtype").value="type"):[].slice.call(document.querySelectorAll('#item-form input[name="jform[menutype]"]')).forEach(t=>{t.value=m}),Joomla.submitform("item.setType",document.getElementById("item-form"))):e==="item.cancel"||document.formvalidator.isValid(document.getElementById("item-form"))?Joomla.submitform(e,document.getElementById("item-form")):document.querySelectorAll("#item-form .modal-value.invalid").forEach(t=>{t.parentElement.querySelector('.js-input-title, [type="text"]').classList.add("invalid")})},window.addEventListener("message",e=>{e.origin===window.location.origin&&e.data.messageType==="joomla:content-select-menutype"&&Joomla.submitbutton("item.setType",e.data.encoded)});const onChange=({target:e})=>{const m=e.value;Joomla.request({url:`index.php?option=com_menus&task=item.getParentItem&menutype=${m}`,headers:{"Content-Type":"application/json"},onSuccess(o){const t=JSON.parse(o),n=document.getElementById("jform_parent_id").closest("joomla-field-fancy-select");n.choicesInstance.clearChoices(),n.choicesInstance.setChoices([{id:"1",text:Joomla.Text._("JGLOBAL_ROOT_PARENT")}],"id","text",!1),t.forEach(r=>{const i={};i.innerText=r.title,i.id=r.id,n.choicesInstance.setChoices([i],"id","innerText",!1)}),n.choicesInstance.setChoiceByValue("1");const l=document.createEvent("HTMLEvents");l.initEvent("change",!0,!1),document.getElementById("jform_parent_id").dispatchEvent(l)},onError:o=>{Joomla.renderMessages(Joomla.ajaxErrorsMessages(o))}})},element=document.getElementById("jform_menutype");element&&element.addEventListener("change",onChange),document.getElementById("item-form").addEventListener("submit",()=>{document.getElementById("jform_params_login_redirect_url")&&document.getElementById("jform_params_logout_redirect_url")&&(document.getElementById("jform_params_login_redirect_url").closest(".control-group").classList.contains("hidden")||(document.getElementById("jform_params_login_redirect_menuitem_id").value=""),document.getElementById("jform_params_login_redirect_menuitem_name").closest(".control-group").classList.contains("hidden")||(document.getElementById("jform_params_login_redirect_url").value=""),document.getElementById("jform_params_logout_redirect_url").closest(".control-group").classList.contains("hidden")||(document.getElementById("jform_params_logout_redirect_menuitem_id").value=""),document.getElementById("jform_params_logout_redirect_menuitem_id").closest(".control-group").classList.contains("hidden")||(document.getElementById("jform_params_logout_redirect_url").value=""))});
