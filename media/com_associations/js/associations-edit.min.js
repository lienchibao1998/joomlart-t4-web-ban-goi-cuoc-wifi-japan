/**
 * @copyright   (C) 2018 Open Source Matters, Inc. <https://www.joomla.org>
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */Joomla=window.Joomla||{},((e,i)=>{e.hideAssociation=(s,n)=>{[].slice.call(i.querySelectorAll("#associations .control-group")).forEach(a=>{const o=a.querySelector(".control-label label");o&&o.getAttribute("for").replace(/_name$/,"")===`${s}_associations_${n.replace("-","_")}`&&a.classList.add("hidden")})},e.showAssociationMessage=()=>{const s=[].slice.call(i.querySelectorAll("#associations .control-group")),n=i.getElementById("associations");if(n){const t=i.createElement("joomla-alert");t.innerText=e.Text._("JGLOBAL_ASSOC_NOT_POSSIBLE"),n.insertAdjacentElement("afterbegin",t)}s.forEach(t=>{t.classList.add("hidden")})},e.injectAssociations=(s,n)=>{let t;s.success?(s.data.length!==0&&[].slice.call(Object.keys(s.data)).forEach(a=>{t=n+a.replace("-","_"),window[t](s.data[a].id,s.data[a].title,s.data[a].catid,null,null,a)}),s.message&&e.renderMessages({notice:[s.message]})):e.renderMessages({warning:[e.Text._("JGLOBAL_ASSOCIATIONS_PROPAGATE_FAILED")]})},e.propagateAssociation=(s,n)=>{const t=i.getElementById(`${s}_id`).value,a=i.getElementById("jform_language"),o=a.options[a.selectedIndex].value,c={task:"ajax.fetchAssociations",format:"json",assocId:t,excludeLang:o};c[e.getOptions("csrf.token","")]=1;const f=Object.keys(c).reduce((d,g)=>(d.push(`${g}=${encodeURIComponent(c[g])}`),d),[]).join("&"),l=`${i.forms.adminForm.action}&${f}`;return e.request({url:l,method:"GET",data:JSON.stringify(c),headers:{"Content-Type":"application/json"},onSuccess:d=>{e.injectAssociations(JSON.parse(d),n)},onError:()=>{e.renderMessages({warning:[e.Text._("JGLOBAL_ASSOCIATIONS_PROPAGATE_FAILED")]})}}),!1},i.addEventListener("DOMContentLoaded",()=>{const s=e.getOptions("system.associations.edit"),n=s.formControl||"jform",t=i.getElementById(`${n}_language`);parseInt(s.hidden,10)===1?e.showAssociationMessage():t&&e.hideAssociation(n,t.value),t&&t.addEventListener("change",({target:a})=>{e.removeMessages();let o=!1;[].slice.call(i.querySelectorAll("#associations .control-group")).forEach(l=>{const g=l.querySelector(".control-label label").getAttribute("for").replace("_name","").replace("jform_associations_","");l.classList.remove("hidden"),!o&&i.getElementById(`${n}_associations_${g}_id`).value!==""&&(o=!0);let r=i.getElementById(`${n}_associations_${g}_clear`);r=r||l.querySelector('[data-button-action="clear"]'),r.onclick?r.onclick():r.click&&r.click()}),o&&e.renderMessages({warning:[e.Text._("JGLOBAL_ASSOCIATIONS_RESET_WARNING")]});const f=a.value;f==="*"?e.showAssociationMessage():e.hideAssociation(n,f)})})})(Joomla,document);
